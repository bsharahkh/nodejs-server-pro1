import{a as O}from"./chunk-MYGKFXKM.js";import{a as G}from"./chunk-T42BHAKM.js";import{a as A,b as W,c as I,d as N,e as F,f as P,g as B,h as L,i as j,j as q,l as z}from"./chunk-JLQQGME4.js";import"./chunk-XARGZZIY.js";import"./chunk-4N62LD7P.js";import{$a as m,Da as M,Fb as k,Ia as h,Ra as S,Sa as C,Ua as D,Va as E,W as c,Wa as n,X as u,Xa as i,Ya as V,Za as v,_a as p,ab as a,bb as y,cb as b,db as g,eb as x,fb as _,ia as f,ua as d,ya as T}from"./chunk-DDVZQDE5.js";import{a as w}from"./chunk-RW4GY4BD.js";var R=(l,s)=>s.id;function H(l,s){l&1&&(n(0,"div",4),V(1,"div",7),i())}function J(l,s){if(l&1&&(n(0,"div",17)(1,"p",18),a(2,"Book Access:"),i(),n(3,"div",19),a(4),i()()),l&2){let t=m().$implicit;d(4),b("",t.access.length," book(s) configured")}}function K(l,s){if(l&1){let t=v();n(0,"div",8)(1,"div",9)(2,"div")(3,"h3",10),a(4),i(),n(5,"p",11),a(6),i(),n(7,"div",12)(8,"span",13),a(9),i(),n(10,"span",13),a(11),i(),n(12,"span"),a(13),i()()(),n(14,"div",14)(15,"button",15),p("debounceClick",function(){let e=c(t).$implicit,o=m(2);return u(o.openEditModal(e))}),a(16,"Edit"),i(),n(17,"button",16),p("debounceClick",function(){let e=c(t).$implicit,o=m(2);return u(o.deleteTier(e.id))}),a(18,"Delete"),i()()(),h(19,J,5,1,"div",17),i()}if(l&2){let t=s.$implicit;d(4),y(t.name),d(2),y(t.description),d(3),b("Price: $",t.price,""),d(2),b("Duration: ",t.duration_days," days"),d(),S(t.active?"text-green-600":"text-red-600"),d(),b(" ",t.active?"Active":"Inactive"," "),d(6),C(t.access&&t.access.length>0?19:-1)}}function Q(l,s){if(l&1&&(n(0,"div",5),D(1,K,20,8,"div",8,R),i()),l&2){let t=m();d(),E(t.tiers())}}function U(l,s){if(l&1){let t=v();n(0,"div",6)(1,"div",20)(2,"h3",21),a(3),i(),n(4,"form",22),p("ngSubmit",function(){c(t);let e=m();return u(e.saveTier())}),n(5,"div")(6,"label",23),a(7,"Name"),i(),n(8,"input",24),_("ngModelChange",function(e){c(t);let o=m();return x(o.formData.name,e)||(o.formData.name=e),u(e)}),i()(),n(9,"div")(10,"label",23),a(11,"Description"),i(),n(12,"textarea",25),_("ngModelChange",function(e){c(t);let o=m();return x(o.formData.description,e)||(o.formData.description=e),u(e)}),i()(),n(13,"div")(14,"label",23),a(15,"Price"),i(),n(16,"input",26),_("ngModelChange",function(e){c(t);let o=m();return x(o.formData.price,e)||(o.formData.price=e),u(e)}),i()(),n(17,"div")(18,"label",23),a(19,"Duration (days)"),i(),n(20,"input",27),_("ngModelChange",function(e){c(t);let o=m();return x(o.formData.duration_days,e)||(o.formData.duration_days=e),u(e)}),i()(),n(21,"div",28)(22,"input",29),_("ngModelChange",function(e){c(t);let o=m();return x(o.formData.active,e)||(o.formData.active=e),u(e)}),i(),n(23,"label",30),a(24,"Active"),i()(),n(25,"div",31)(26,"button",32),a(27," Save "),i(),n(28,"button",33),p("debounceClick",function(){c(t);let e=m();return u(e.closeModal())}),a(29," Cancel "),i()()()()()}if(l&2){let t=m();d(3),y(t.editingTier()?"Edit Tier":"Create Tier"),d(5),g("ngModel",t.formData.name),d(4),g("ngModel",t.formData.description),d(4),g("ngModel",t.formData.price),d(4),g("ngModel",t.formData.duration_days),d(2),g("ngModel",t.formData.active)}}var re=(()=>{let s=class s{constructor(r){this.tierService=r,this.tiers=f([]),this.loading=f(!1),this.showModal=f(!1),this.editingTier=f(null),this.formData={name:"",description:"",price:0,duration_days:30,active:!0}}ngOnInit(){this.loadTiers()}loadTiers(){this.loading.set(!0),this.tierService.list({pageSize:100}).subscribe({next:r=>{this.tiers.set(r.items||[]),this.loading.set(!1)},error:()=>this.loading.set(!1)})}openCreateModal(){this.editingTier.set(null),this.formData={name:"",description:"",price:0,duration_days:30,active:!0},this.showModal.set(!0)}openEditModal(r){this.editingTier.set(r),this.formData=w({},r),this.showModal.set(!0)}closeModal(){this.showModal.set(!1)}saveTier(){(this.editingTier()?this.tierService.update(this.editingTier().id,this.formData):this.tierService.create(this.formData)).subscribe({next:()=>{this.closeModal(),this.loadTiers()}})}deleteTier(r){confirm("Are you sure?")&&this.tierService.delete(r).subscribe(()=>this.loadTiers())}};s.\u0275fac=function(e){return new(e||s)(T(O))},s.\u0275cmp=M({type:s,selectors:[["app-admin-tiers"]],decls:9,vars:2,consts:[[1,"max-w-7xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-3xl","font-semibold","text-gray-900"],["appDebounceClick","",1,"btn","btn-primary",3,"debounceClick"],[1,"text-center","py-12"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-4","sm:gap-6"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","p-4","z-50"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"bg-white","rounded-lg","shadow-sm","p-5","sm:p-6","border","border-gray-200"],[1,"flex","justify-between","items-start","mb-3","sm:mb-4"],[1,"text-lg","sm:text-xl","font-semibold","text-gray-900","leading-7"],[1,"text-sm","text-gray-600","mt-1","leading-6"],[1,"mt-2","flex","flex-wrap","gap-x-4","gap-y-1","text-sm"],[1,"text-gray-700"],[1,"flex","flex-wrap","gap-2"],["appDebounceClick","",1,"btn","btn-outline","btn-sm",3,"debounceClick"],["appDebounceClick","",1,"btn","btn-danger","btn-sm",3,"debounceClick"],[1,"border-t","pt-4","mt-2"],[1,"text-sm","font-medium","text-gray-700","mb-2"],[1,"text-xs","text-gray-600","leading-5"],[1,"bg-white","rounded-lg","p-6","w-full","max-w-md"],[1,"text-xl","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","name","name","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["name","description","rows","2",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","number","name","price","step","0.01","min","0",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],["type","number","name","duration_days","min","1",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"flex","items-center"],["type","checkbox","name","active","id","active",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","active",1,"ml-2","text-sm","text-gray-700"],[1,"flex","gap-3"],["type","submit",1,"flex-1","bg-blue-600","text-white","py-2","px-4","rounded-md","hover:bg-blue-700"],["type","button","appDebounceClick","",1,"flex-1","bg-gray-200","text-gray-800","py-2","px-4","rounded-md","hover:bg-gray-300",3,"debounceClick"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Manage Tiers"),i(),n(4,"button",3),p("debounceClick",function(){return o.openCreateModal()}),a(5," Add Tier "),i()(),h(6,H,2,0,"div",4)(7,Q,3,0,"div",5)(8,U,30,6,"div",6),i()),e&2&&(d(6),C(o.loading()?6:7),d(2),C(o.showModal()?8:-1))},dependencies:[k,z,B,W,L,A,I,N,q,j,P,F,G],encapsulation:2});let l=s;return l})();export{re as AdminTiersComponent};
